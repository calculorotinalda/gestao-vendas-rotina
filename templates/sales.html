{% extends "base.html" %}

{% block title %}Vendas - GestVendas{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="fas fa-shopping-cart me-2"></i>Gestão de Vendas</h2>
    <a href="{{ url_for('add_sale') }}" class="btn btn-primary">
        <i class="fas fa-plus me-2"></i>Nova Venda
    </a>
</div>

<!-- Stats Cards -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="stat-card">
            <div class="stat-icon bg-success">
                <i class="fas fa-euro-sign"></i>
            </div>
            <div class="stat-info">
                <h3>€0,00</h3>
                <p>Total de Vendas</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card">
            <div class="stat-icon bg-info">
                <i class="fas fa-receipt"></i>
            </div>
            <div class="stat-info">
                <h3>0</h3>
                <p>Vendas Hoje</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card">
            <div class="stat-icon bg-warning">
                <i class="fas fa-chart-line"></i>
            </div>
            <div class="stat-info">
                <h3>€0,00</h3>
                <p>Média Mensal</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card">
            <div class="stat-icon bg-primary">
                <i class="fas fa-users"></i>
            </div>
            <div class="stat-info">
                <h3>0</h3>
                <p>Clientes Ativos</p>
            </div>
        </div>
    </div>
</div>

<!-- Sales Table -->
<div class="data-card">
    <div class="header">
        <h5><i class="fas fa-list me-2"></i>Lista de Vendas</h5>
        <span class="badge bg-secondary">{{ sales.total }} vendas</span>
    </div>
    
    {% if sales.data %}
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Fatura</th>
                        <th>Cliente</th>
                        <th>Data</th>
                        <th>Total</th>
                        <th>Status</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    {% for sale in sales.data %}
                        <tr>
                            <td><code>{{ sale.invoice_number }}</code></td>
                            <td>Cliente #{{ sale.customer_id }}</td>
                            <td>{{ sale.sale_date.strftime('%d/%m/%Y') if sale.sale_date else 'N/A' }}</td>
                            <td><strong>{{ format_currency(sale.total_amount) }}</strong></td>
                            <td>
                                <span class="badge bg-success">{{ sale.status|title if sale.status else 'Pendente' }}</span>
                            </td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="alert('Ver detalhes em desenvolvimento')">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-success" onclick="alert('Imprimir fatura em desenvolvimento')">
                                    <i class="fas fa-print"></i>
                                </button>
                                <a href="{{ url_for('delete_sale', id=sale.id) }}" 
                                   class="btn btn-sm btn-outline-danger"
                                   onclick="return confirm('Tem certeza que deseja eliminar esta venda?')">
                                    <i class="fas fa-trash"></i>
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <div class="empty-state">
            <i class="fas fa-shopping-cart fa-3x text-muted mb-3"></i>
            <h5>Nenhuma venda registada</h5>
            <p class="text-muted">Registre a primeira venda para começar a utilizar o sistema.</p>
        </div>
    {% endif %}
</div>
{% endblock %}